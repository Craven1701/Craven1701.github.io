I"Ô"<p>æè¿™ä¸ªäº‹æƒ…çš„åˆè¡·æ˜¯å› ä¸ºå°åˆ°äº†gitç”œå¤´æƒ³è¦æç‚¹äº‹æƒ…è€Œå·²ã€‚</p>

<p>å› ä¸º.docæ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œgitåªèƒ½æ˜¾ç¤ºçº¯æ–‡æœ¬æ–‡æ¡£çš„ä¿®æ”¹å˜åŒ–ï¼Œæ‰€ä»¥å¸¦ä¸Š<code class="language-plaintext highlighter-rouge">pandoc</code>ä½œä¸€ä¸‹æ ¼å¼è½¬æ¢ã€‚</p>

<p><strong>å‚è€ƒèµ„æ–™ï¼š</strong>
<a href="https://blog.csdn.net/GAI159/article/details/105025312/">https://blog.csdn.net/GAI159/article/details/105025312/</a>
<a href="https://www.cnblogs.com/yezuhui/p/6853271.html">https://www.cnblogs.com/yezuhui/p/6853271.html</a>
<a href="https://github.com/vigente/gerardus/wiki/Integrate-git-diffs-with-word-docx-files">https://github.com/vigente/gerardus/wiki/Integrate-git-diffs-with-word-docx-files</a>
<a href="https://www.jianshu.com/p/6ba04f669d0b">Pandocçš„å®‰è£…ä¸ä½¿ç”¨</a></p>

<h2 id="pandocç®€ä»‹">Pandocç®€ä»‹</h2>
<p>æœ¬éƒ¨åˆ†å†…å®¹å‚è€ƒ
 <a href="https://www.jianshu.com/p/6ba04f669d0b">Pandocçš„å®‰è£…ä¸ä½¿ç”¨</a>
ä½œè€…ï¼šgrug350   			æ¥æºï¼šç®€ä¹¦
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

<p>å®˜ç½‘ï¼š<a href="https://www.pandoc.org/">Pandoc</a></p>

<p>Pandocæ˜¯ä¸ªå¥½ç”¨çš„æ–‡æœ¬æ ¼å¼è½¬åŒ–å™¨ã€‚å®ƒå¯ä»¥å°†æ–‡æ¡£åœ¨ Markdownã€LaTeXã€reStructuredTextã€HTMLã€Word docx ç­‰å¤šç§æ ‡è®°æ ¼å¼ä¹‹é—´ç›¸äº’è½¬æ¢ï¼Œå¹¶æ”¯æŒè¾“å‡º PDFã€EPUBã€HTML å¹»ç¯ç‰‡ç­‰å¤šç§æ ¼å¼ã€‚è¯¥ç¨‹åºè¢«ç§°ä¸ºæ ¼å¼è½¬æ¢ç•Œçš„ â€œç‘å£«å†›åˆ€â€ã€‚è¿™é‡Œç”¨æ¥æŠŠwordè½¬æˆmarkdownï¼Œå¥½è®©æˆ‘ä»¬èƒ½åœ¨gitçš„ç®¡ç†ä¸‹çœ‹è§è¯¦ç»†çš„ç‰ˆæœ¬æ§åˆ¶ä¿¡æ¯ã€‚</p>

<p>###1. å®‰è£…
å®‰è£…å‚è€ƒå®˜ç½‘å°±å¥½ï¼Œæ”¯æŒWindows,macOS,Linuxã€‚Linuxè›®å¤šå‘è¡Œç‰ˆè‡ªå¸¦è¿™ä¸ªï¼Œæ¯”å¦‚Ubuntuï¼Œæˆ–åˆ™è¯´å¦‚æœå®‰è£…è¿‡Anacoda,é‚£ä¹ˆpandocä¹Ÿä¼šåŒæ—¶è£…å…¥ç”µè„‘ä¸­ã€‚</p>

<p>æˆ‘çš„ç”µè„‘é‡Œè£…äº†Anacoda,æ‰€ä»¥ç›´æ¥æ‹¿æ¥ç”¨å°±å¥½äº†ã€‚</p>

<p>###2.pandocåŸºæœ¬ä½¿ç”¨</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pandoc <span class="o">[</span>OPTIONS] <span class="o">[</span>FILES]

<span class="c">#åŸºæœ¬å‚æ•°è¯´æ˜</span>
å…¶ä¸­Â &lt;files&gt;Â ä¸ºè¾“å…¥çš„å†…å®¹ï¼Œå…¶è¾“å…¥å³å¯ä»¥æ¥è‡ªæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ¥è‡ªæ ‡å‡†è¾“å…¥ç”šè‡³ç½‘é¡µé“¾æ¥ã€‚è€ŒÂ &lt;options&gt;Â ä¸ºå‚æ•°é€‰é¡¹ã€‚ä¸»è¦çš„å‚æ•°é€‰é¡¹æœ‰ï¼š

<span class="nt">-f</span> &lt;format&gt;ã€-r &lt;format&gt; <span class="c"># æŒ‡å®šè¾“å…¥æ–‡ä»¶æ ¼å¼ï¼Œé»˜è®¤ä¸º Markdownï¼›</span>
<span class="nt">-t</span> &lt;format&gt;ã€-w &lt;format&gt; <span class="c"># æŒ‡å®šè¾“å‡ºæ–‡ä»¶æ ¼å¼ï¼Œé»˜è®¤ä¸º HTMLï¼›</span>
æ³¨æ„ï¼šä¸Šè¿°ä¸¤é¡¹pandocå¯ä»¥æ ¹æ®æ–‡ä»¶æ‹“å±•åè‡ªå·±è¯†åˆ«ï¼Œä¸è¾“å…¥ä¹Ÿè¡Œ
<span class="nt">-o</span> &lt;file&gt; <span class="c"># æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œè¯¥é¡¹ç¼ºçœæ—¶ï¼Œå°†è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼›</span>
<span class="nt">--highlight-style</span> &lt;style&gt; <span class="c"># è®¾ç½®ä»£ç é«˜äº®ä¸»é¢˜ï¼Œé»˜è®¤ä¸ºÂ pygmentsï¼›</span>
<span class="nt">-s</span> <span class="c"># ç”Ÿæˆæœ‰å¤´å°¾çš„ç‹¬ç«‹æ–‡ä»¶ï¼ˆHTMLï¼ŒLaTeXï¼ŒTEI æˆ– RTFï¼‰ï¼›</span>
<span class="nt">-S</span> <span class="c"># èªæ˜æ¨¡å¼ï¼Œæ ¹æ®æ–‡ä»¶åˆ¤æ–­å…¶æ ¼å¼ï¼›</span>
<span class="nt">--self-contained</span> <span class="c"># ç”Ÿæˆè‡ªåŒ…å«çš„æ–‡ä»¶ï¼Œä»…åœ¨è¾“å‡º HTML æ–‡æ¡£æ—¶æœ‰æ•ˆï¼›</span>
<span class="nt">--verbose</span> <span class="c"># å¼€å¯ Verbose æ¨¡å¼ï¼Œç”¨äº Debugï¼›</span>
<span class="nt">--list-input-formats</span> <span class="c"># åˆ—å‡ºæ”¯æŒçš„è¾“å…¥æ ¼å¼ï¼›</span>
 <span class="c"># åˆ—å‡ºæ”¯æŒçš„è¾“å‡ºæ ¼å¼ï¼›</span>
<span class="nt">--list-extensions</span> <span class="c"># åˆ—å‡ºæ”¯æŒçš„ Markdown æ‰©å±•æ–¹æ¡ˆï¼›</span>
<span class="nt">--list-highlight-languages</span> <span class="c"># åˆ—å‡ºæ”¯æŒä»£ç é«˜äº®çš„ç¼–ç¨‹è¯­è¨€ï¼›</span>
<span class="nt">--list-highlight-styles</span> <span class="c"># åˆ—å‡ºæ”¯æŒçš„ä»£ç é«˜äº®ä¸»é¢˜ï¼›</span>
<span class="nt">-v</span>ã€--version <span class="c"># æ˜¾ç¤ºç¨‹åºçš„ç‰ˆæœ¬å·ï¼›</span>
<span class="nt">-h</span>ã€--help <span class="c"># æ˜¾ç¤ºç¨‹åºçš„å¸®åŠ©ä¿¡æ¯ã€‚</span>

<span class="c">#ä½¿ç”¨ç¤ºèŒƒ</span>
pandoc input.docx <span class="nt">-o</span> output.md <span class="c">#æŠŠæˆ‘çš„wordè½¬æˆmarkdown</span>
pandoc input.md <span class="nt">-o</span> output.docx
</code></pre></div></div>

<p>##å®ç°å¯¹wordæ–‡æ¡£çš„ç‰ˆæœ¬æ§åˆ¶
å‚è€ƒæ•™ç¨‹åœ°å€ï¼š<a href="https://github.com/vigente/gerardus/wiki/Integrate-git-diffs-with-word-docx-files">https://github.com/vigente/gerardus/wiki/Integrate-git-diffs-with-word-docx-files</a></p>

<p>This section was inspired by Martin Fennerâ€™s â€œUsing Microsoft Word with gitâ€.</p>

<p>To configure git diff:</p>

<p>Install pandoc.</p>

<p>Tell git how to handle diffs of .docx files.</p>

<p>Create or edit file ~/.gitconfig (linux, Mac) or â€œc:\Documents and Settings\user.gitconfigâ€ (Windows) to add</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="o">[</span>diff <span class="s2">"pandoc"</span><span class="o">]</span>
   <span class="nv">textconv</span><span class="o">=</span>pandoc <span class="nt">--to</span><span class="o">=</span>markdown
   prompt <span class="o">=</span> <span class="nb">false</span>
 <span class="o">[</span><span class="nb">alias</span><span class="o">]</span>
   wdiff <span class="o">=</span> diff <span class="nt">--word-diff</span><span class="o">=</span>color <span class="nt">--unified</span><span class="o">=</span>1
</code></pre></div></div>
<p>In your paper directory, create or edit file<code class="language-plaintext highlighter-rouge"> .gitattributes</code> (linux, Windows and Mac) to add</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span>.docx <span class="nv">diff</span><span class="o">=</span>pandoc
</code></pre></div></div>
<p>You can commit .gitattributes so that it stays with your paper for use in other computers, but youâ€™ll need to edit<code class="language-plaintext highlighter-rouge"> ~/.gitconfig</code> in every new computer you want to use.</p>

<p>========================================================================================================================================</p>

<h3 id="gitattributes">ã€<strong>.gitattributes</strong>ã€‘</h3>

<p>ç¨å¾®è¯´æ˜ä¸€ä¸‹<code class="language-plaintext highlighter-rouge">.gitatrributes</code>è¿™ä¸ªæ–‡ä»¶ã€‚å®˜ç½‘é“¾æ¥ï¼š<a href="https://git-scm.com/docs/gitattributes">gitattributes documents</a> 
è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä½œç”¨æ˜¯ä¸º<code class="language-plaintext highlighter-rouge">attributes</code>æä¾›ä¸€ä¸ªè·¯å¾„å</p>

<p>æ–‡ä»¶çš„åŸºæœ¬æ ¼å¼</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pattern attr1 attr2 ...
</code></pre></div></div>
<p>æ˜¯ä¸€ä¸ªpatternè·Ÿéšä¸€ä¸²çš„attrs, è¿™ä¸ªpatternæˆ‘ç†è§£çš„æ˜¯æŸç§åŒ¹é…æ¨¡å¼ï¼Œç„¶åä¼šæ‰¾åˆ°ç¬¦åˆè¿™ç§åŒ¹é…æ¨¡å¼çš„æ–‡ä»¶ï¼Œç”¨åé¢çš„attrså¯¹è¿™ä¸ªæ–‡ä»¶çš„æ“ä½œè¿›è¡Œè§„èŒƒã€‚
ä¸Šæ–‡ä¸­çš„ <code class="language-plaintext highlighter-rouge">*.docx diff=pandoc</code> è¡¨ç¤ºå¯¹äºæ‰€æœ‰.docxçš„æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨diffæ—¶ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨[diff â€œpandocâ€] è¿™ä¸ªsubsectioné‡Œé¢çš„é…ç½®ã€‚</p>

<p>========================================================================================================================================</p>

<p>Now you can see a pretty coloured diff with the changes you have made to your .docx file since the last commit
<code class="language-plaintext highlighter-rouge">git wdiff file.docx</code></p>

<p>To see all changes over time
<code class="language-plaintext highlighter-rouge">git log -p --word-diff=color file.docx</code></p>

<p>Track changes in Word (.docx) documents getting a diff with the commit.
Automatically when running git commit.
This is only going to work from linux/Mac or Windows running git from a bash shell.</p>

<p>Install pandoc. Pandoc is a program to convert between different file formats. Itâ€™s going to allow us to convert Word files (.docx) to Markdown (.md).</p>

<p>Set up git hooks to enable automatic generation and tracking of Markdown copies of .docx files.</p>

<p>Copy these hook files to your git projectâ€™s .git/hooks directory and rename them, or soft-link to them with ln -s, and make them executable<code class="language-plaintext highlighter-rouge"> (chmod u+x *.sh)</code>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pre-commit-git-diff-docx.sh -&gt; .git/hooks/pre-commit
post-commit-git-diff-docx.sh -&gt; .git/hooks/post-commit
</code></pre></div></div>
<p>Now every time you run git commit, the pre-commit hook will automatically run before you see the window to enter the log message. The hook is a script that makes a copy in Markdown format (.md) of every .docx file you are committing. The post-commit hook then amends the commit adding the .md files.</p>

:ET